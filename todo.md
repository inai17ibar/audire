# Shadowing App TODO

## 初期設定
- [x] アプリ名とロゴの設定
- [x] デザインドキュメント(design.md)の作成

## 記事管理機能
- [x] 記事一覧画面の実装
- [x] 記事詳細画面の実装
- [x] カテゴリフィルター機能
- [ ] 難易度フィルター機能
- [ ] Engoo Daily Newsスクレイパーの実装
- [x] 記事データのローカルストレージ保存

## 音声機能
- [x] OpenAI TTS APIの統合
- [x] 記事音声の生成と保存
- [x] 音声再生コントロール（再生/一時停止/停止）
- [x] 再生速度調整機能（0.5x, 0.75x, 1.0x, 1.25x, 1.5x）
- [x] 10秒戻る/進む機能
- [ ] 文章ごとのリピート再生機能

## 録音機能
- [x] expo-audioを使った録音機能の実装
- [x] 録音開始/停止ボタン
- [ ] 録音音声の再生機能
- [x] 録音ファイルのローカル保存

## AI発音レビュー機能
- [x] OpenAI Whisper APIの統合
- [x] 録音音声の文字起こし
- [x] 元テキストとの比較ロジック
- [x] GPT APIによるフィードバック生成
- [x] レビュー結果表示画面
- [x] スコア表示（0-100）

## スクリプト表示機能
- [x] 記事本文の表示
- [x] 表示モード切替（英文のみ/英文+日本語訳/非表示）
- [ ] 現在再生中の文のハイライト表示

## 学習進捗管理
- [x] 練習履歴の保存
- [x] 学習履歴画面の実装
- [ ] スコア推移グラフ
- [x] 学習ストリーク（連続日数）表示
- [x] 週間目標達成状況の表示

## UI/UX
- [ ] ホーム画面のデザイン
- [ ] 練習画面のデザイン
- [ ] レビュー画面のデザイン
- [ ] ダークモード対応
- [ ] ハプティックフィードバックの追加

## テストとデバッグ
- [ ] 全機能の動作確認
- [ ] エラーハンドリングの実装
- [ ] パフォーマンス最適化

## バグ修正
- [x] アイコン画像の生成と配置（ビルドエラー修正）
- [x] 依存関係のクリーンアップ

## 新規タスク（ユーザーリクエスト）
- [x] 音声読み上げの問題を調査・修正
- [x] 現在読んでいる単語のハイライト機能を実装
- [x] 録音機能のテストコード作成

## 緊急バグ修正
- [x] TTS API 500エラーの原因調査と修正

## 新規バグ修正・機能追加
- [x] 録音機能のBufferエラーを修正（ブラウザ環境対応）
- [x] 録音後のAIレビュー機能を追加
- [x] レビュー結果画面の改善

## UX改善
- [x] 録音アップロード中のプログレスバーを追加
- [x] AIレビュー中のプログレスバーを追加
- [x] 処理ステップの表示（アップロード中、文字起こし中、分析中）

## AIレビュー履歴機能
- [x] レビュー結果の永続化（AsyncStorage）
- [x] レビュー履歴一覧画面の作成
- [x] 個別レビュー詳細画面の作成
- [x] レビュー履歴からの再確認機能
- [ ] レビュー履歴の削除機能

## Engoo Daily Newsスクレイパー
- [x] サーバー側にスクレイパーAPIエンドポイントを作成
- [x] Engoo Daily Newsの記事一覧ページをスクレイピング
- [x] 記事の詳細情報を取得（タイトル、カテゴリ、レベル、日付、本文）
- [x] 引用元の名前とURLを記事の最後に追加
- [x] クライアント側で取得した記事を表示
- [x] 記事の更新機能を実装

## 音声キャッシュ機能
- [x] 音声生成時にS3にアップロード
- [x] 記事データに音声URLとキャッシュ日時を保存
- [x] キャッシュ期間の管理（7日間）
- [x] 既存音声の再利用ロジック
- [x] キャッシュクリア機能

## オフライン再生機能
- [x] ArticleタイプにlocalAudioPathフィールドを追加
- [x] expo-file-systemを使った音声ファイルのダウンロード機能
- [x] ダウンロード進捗表示
- [x] ネットワーク状態の検出（expo-network）
- [x] オフライン時のローカルファイル自動切替
- [x] ダウンロード済みファイルの管理（一覧表示、削除）
- [x] ストレージ容量の表示

## 新規機能（ユーザーリクエスト）
- [x] 音声再生のシークバー（スクロールバー）を手動操作可能に
- [x] 記事ごとの学習記録（練習回数、累計学習時間、最高スコア）
- [x] バッジ・実績システム
- [x] 連続学習日数の表示
- [x] 目標達成の視覚化

## 新規タスク（ユーザーリクエスト）
- [x] 記事詳細画面に学習記録を表示（練習回数、最高スコア、最終練習日、累計学習時間）

## バグ修正（新規）
- [x] English+Japaneseボタンで日本語訳が表示されない問題を修正

## バグ修正（緊急）
- [x] English+Japaneseボタンを押しても日本語訳が表示されない問題を調査・修正

## 自動翻訳機能（新規）
- [x] サーバー側にGPT API翻訳エンドポイントを作成
- [x] Discoverタブに自動翻訳機能を統合
- [x] 翻訳進捗表示の実装
- [x] 翻訳機能のテストを作成

## UI改善（新規）
- [x] English+Japaneseモードで英語段落と日本語訳段落を交互に表示
- [x] 段落交互表示のテストを作成

## 段落音声再生機能（新規）
- [x] 段落ごとのTTS音声再生コンポーネントを作成
- [x] InterleavedTextコンポーネントに音声再生ボタンを統合
- [x] 段落音声再生機能のテストを作成

## 段落音声ハイライト機能（新規）
- [x] ParagraphAudioButtonに再生時間追跡機能を追加
- [x] InterleavedTextで段落音声再生時のハイライトを実装
- [x] ハイライト機能のテストを作成

## 段落音声キャッシュ機能（新規）
- [x] AsyncStorageを使用した段落TTS音声キャッシュ機能を実装
- [x] キャッシュ機能のテストを作成

## バグ修正（緊急）
- [x] 練習画面でWeb版のexpo-audioネイティブモジュールエラーを修正

## バグ修正（緊急）
- [x] Discoverタブで取得した記事がホーム画面に追加されないバグを修正

## 記事取得機能改善（緊急）
- [x] Engoo Daily Newsからの記事取得アルゴリズムを調査・改善
- [x] 記事取得の成功率を向上させる
- [x] 改善した記事取得機能のテストを作成

## 複数ニュースソース対応（緊急）
- [x] BBC Learning Englishスクレイパーを実装
- [x] VOA Learning Englishスクレイパーを実装
- [x] Discoverタブに記事ソース選択機能を追加
- [x] 複数ソース対応のテストを作成

## 録音音声再生機能（新規）
- [x] 練習画面に録音音声の再生ボタンを追加
- [x] 録音音声の再生機能を実装
- [x] 録音音声再生機能のテストを作成

## 難易度フィルター機能（新規）
- [x] ホーム画面に難易度フィルターUIを追加
- [x] 難易度フィルター機能を実装
- [x] 難易度フィルター機能のテストを作成

## 記事取得バグ修正（緊急）
- [x] BBC/VOAで取得した記事がホーム画面に追加されない問題を修正
- [x] Engooスクレイパーのセレクタを再調査・修正
- [x] 記事取得バグ修正のテストを作成

## 記事取得失敗問題（緊急）
- [x] サーバーログを確認してスクレイピング失敗の原因を特定
- [x] DiscoverタブのAPI呼び出しを正しいJSON形式に修正（0件保存問題）
- [x] Engooスクレイパーのロジックを調査（JavaScript動的レンダリングのため対応困難、BBC/VOAを使用推奨）
- [x] 記事取得失敗問題の修正テストを作成

## 中央サーバー記事配信システム（新規）
- [x] データベースに記事保存用のテーブルを作成
- [ ] 記事取得・翻訳・保存のcronジョブを実装
- [ ] アプリ向けの記事配信APIエンドポイントを実装
- [ ] Discoverタブを記事配信API対応に変更
- [ ] 中央サーバー記事配信システムのテストを作成

## サーバー記事配信とプルダウンリフレッシュ（新規）
- [x] 記事配信APIエンドポイントを実装
- [x] ホーム画面にプルダウンリフレッシュ機能を追加
- [x] Discoverタブを削除してUIをシンプル化
- [x] サーバー記事配信システムのテストを作成

## cronジョブスケジュール設定（新規）
- [x] cronジョブスケジューラーをサーバー起動時に自動開始
- [x] cronジョブの実行ログと監視機能を追加
- [x] cronジョブスケジュール設定のテストを作成

## AI発音レビュー機能の改善（新規）
- [x] AIレビュープロンプトを改善して詳細な分析を追加
- [x] 単語レベルの発音分析と具体的な改善例を追加
- [x] レビュー結果画面のUIを改善して詳細情報を表示
- [x] AI発音レビュー機能改善のテストを作成

## GitHubリポジトリへのプッシュ（新規）
- [ ] GitHubリポジトリをクローンしてプロジェクトファイルを準備
- [ ] プロジェクトファイルをリポジトリにコピーしてコミット
- [ ] GitHubリポジトリにプッシュして確認
